# 作品描述

基于 Unity 开发的高性能 UI 框架项目，采用模块化设计，实现了完整的 UI 管理系统、高效列表渲染组件和可扩展红点提示系统。项目以 Presenter/Panel 驱动业务逻辑、View 负责表现与事件转发、Model 管理数据，保证逻辑层与 Unity 表现层解耦，支持多层级 UI 管理、模态窗口交互与面板生命周期控制。

UI 架构采用 MVP 三层分离：纯 C# 逻辑层（Presenter/BaseUIPanel）处理业务流程，适配器层（View/MonoPanel）承接 Unity 生命周期与组件更新，数据层（Model）管理面板状态。通过 UIStack 实现栈式面板管理，支持面板 Pause/Resume；结合工厂与配置注册机制实现类型安全的面板创建；通过 UIManager 统一调度面板显示、隐藏与资源生命周期。

无限循环列表组件采用对象池进行 Item 复用，仅渲染视口可见区域，支持垂直/水平滚动、多列布局与动态视口计算。通过按需创建与回收策略，显著降低 Draw Call 与内存占用，可配置 Item 尺寸、间距、Padding，适用于背包、邮件、排行榜等中高频列表场景。

红点系统采用“红点名（显示位置）”与“红点运算单元（计算逻辑）”解耦设计，支持多对多映射与动态注册/注销。当前实现支持两类运算单元：

- 叶子单元（Leaf）：直接执行业务计算函数（支持无 ID 和带 ID 两种形式）。
- 聚合单元（Composite）：基于其他运算单元缓存结果进行聚合（如 `MAIN_UI_CHARACTER_NEW` 聚合 `CHARACTER_STORY_NEW` 与 `CHARACTER_CG_NEW`）。

系统内部维护运算单元依赖反向索引，`MarkDirty` 后可自动向上游聚合单元传播；更新阶段按“先带 ID，后非 ID/聚合”顺序执行，确保聚合读取到最新子单元快照。为满足 UI 上下文切换场景，当前 Dirty 处理策略为“受影响红点名均触发回调”（不再仅限值变化时回调）。

另外，红点绑定能力支持“绑定并回放当前结果”（`BindRedDotNameAndReplayCurrent`），用于首帧显示和界面重进场景。最近已将 MainPanel 红点绑定与计算逻辑从 View 下沉到 Panel，与 CharacterPanel 保持一致的职责边界：Panel 负责红点逻辑，View 仅负责展示。
